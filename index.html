<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ======================
       â‘  Meta & Title & Bootstrap å¼•å…¥
       ====================== -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bijander 35â€ Velvet Task Chair - Product Page</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- ======================
       â‘  CSS æ ·å¼åŒº
       ====================== -->
  <style>
    /* â‘ -1 Reset & Base æ ·å¼ */
    body {
      background: #f4f4f4;
      font-family: 'Roboto', sans-serif;
    }

    /* â‘ -2 Breadcrumb æ ·å¼ */
    .breadcrumb a {
      color: #6c757d;
      text-decoration: none;
    }

    .breadcrumb a:hover {
      text-decoration: underline;
    }

    /* â‘ -3 äº§å“ç”»å»Šæ ·å¼ */
    .product-gallery {
      position: relative;
    }

    .main-img {
      width: 100%;
      border-radius: 8px;
    }

    .thumbs {
      margin-top: 8px;
      display: flex;
      gap: 8px;
    }

    .thumbs img {
      width: 64px;
      height: 64px;
      object-fit: cover;
      border-radius: 4px;
      cursor: pointer;
      border: 2px solid transparent;
    }

    .thumbs img.active {
      border-color: #007bff;
    }

    /* â‘ -4 äº§å“ä¿¡æ¯æ ·å¼ */
    .product-title {
      font-size: 28px;
      font-weight: 700;
    }

    .product-sub {
      color: #555;
      margin-top: 4px;
    }

    .rating {
      color: #ffc107;
      font-size: 1.1rem;
    }

    .rating~span {
      margin-left: 8px;
      color: #888;
    }

    .price {
      font-size: 26px;
      font-weight: 700;
      color: #d43f3a;
      margin-top: 12px;
    }

    .variant-label {
      font-weight: 500;
      margin-top: 16px;
    }

    /* â‘ -5 æŒ‰é’®æ ·å¼ */
    .btn-primary {
      background: #007bff;
      border: none;
    }

    .btn-primary:hover {
      background: #0056b3;
    }

    /* â‘ -6 è¯¦æƒ…åŒºåŸŸæ ·å¼ */
    .details-section {
      background: #fff;
      padding: 24px;
      border-radius: 8px;
      margin-top: 24px;
    }

    .details-section h4 {
      font-weight: 600;
    }

    .specs dt {
      font-weight: 500;
    }

    /* â‘ -7 è¯„ä»·æ ·å¼ */
    .reviews .review {
      border-bottom: 1px solid #e9ecef;
      padding: 16px 0;
    }

    /* â‘ -8 ç›¸å…³äº§å“æ ·å¼ */
    .related .card {
      border: 1px solid #eaeaea;
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
    }

    .related .card img {
      object-fit: cover;
      height: 180px;
      width: 100%;
    }

    .related .card-body {
      padding: 12px;
    }

    /* â‘ -9 æ¶ˆæ¯æç¤ºæ ·å¼ */
    #message {
      margin-top: 12px;
      min-height: 20px;
      font-weight: 600;
    }

    #message.info {
      color: #0d6efd;
    }

    #message.success {
      color: #198754;
    }

    #message.error {
      color: #dc3545;
    }


/* â‘ -10 è´­ç‰©è½¦æŠ½å±‰æ ·å¼ - é«˜çº§ä¸“ä¸šç‰ˆ */
#cartDrawer {
  position: fixed;
  top: 0;
  right: -400px;
  width: 400px;
  height: 100vh;
  background: #ffffff;
  box-shadow: -6px 0 24px rgba(0, 0, 0, 0.16);
  border-radius: 12px 0 0 12px;
  transition: right 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  overflow-y: auto;
  z-index: 1300;
  display: flex;
  flex-direction: column;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

#cartDrawer.open {
  right: 0;
}

.cart-drawer-header {
  padding: 24px 28px;
  border-bottom: 1px solid #e5e5e5;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: 700;
  font-size: 1.4rem;
  color: #222222;
  background-color: #f9f9f9;
  user-select: none;
}

.cart-drawer-header span {
  display: flex;
  align-items: center;
  gap: 10px;
}

.close-btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: #ececec;
  border: none;
  font-size: 1.5rem;
  color: #555555;
  cursor: pointer;
  transition: background-color 0.3s ease, color 0.3s ease;
}

.close-btn:hover {
  background-color: #7A42F4;
  color: #fff;
}

.cart-drawer-body {
  flex-grow: 1;
  padding: 24px 28px;
  overflow-y: auto;
  color: #444444;
  font-size: 0.95rem;
  display: flex;
  flex-direction: column;
}

.checkout-hint {
  font-weight: 600;
  color: #7A42F4;
  margin-bottom: 24px;
  font-size: 0.9rem;
  letter-spacing: 0.03em;
}

/* å•†å“åˆ—è¡¨ */
.cart-item {
  display: flex;
  gap: 16px;
  padding: 14px 0;
  border-bottom: 1px solid #f0f0f0;
}

.cart-item:last-child {
  border-bottom: none;
}

.item-image {
  width: 80px;
  height: 80px;
  border-radius: 8px;
  object-fit: cover;
  flex-shrink: 0;
  box-shadow: 0 2px 6px rgba(0,0,0,0.12);
}

.item-details {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.item-title {
  font-weight: 600;
  font-size: 1.1rem;
  color: #222;
  margin-bottom: 6px;
  line-height: 1.2;
}

.item-variant {
  font-size: 0.85rem;
  color: #666;
  margin-bottom: 12px;
}

.item-price-qty {
  display: flex;
  align-items: center;
  gap: 14px;
}

.item-price {
  font-weight: 700;
  font-size: 1.05rem;
  color: #7A42F4;
  min-width: 70px;
}

.item-qty {
  width: 56px;
  padding: 6px 8px;
  font-size: 1rem;
  border: 1px solid #ccc;
  border-radius: 6px;
  outline-offset: 2px;
  transition: border-color 0.2s ease;
}

.item-qty:focus {
  border-color: #7A42F4;
  box-shadow: 0 0 5px rgba(122, 66, 244, 0.6);
}

.item-remove-btn {
  background: none;
  border: none;
  color: #888;
  font-size: 1.3rem;
  cursor: pointer;
  transition: color 0.25s ease;
}

.item-remove-btn:hover {
  color: #7A42F4;
}

/* ä»·æ ¼æ±‡æ€» */
.cart-summary {
  margin-top: 28px;
  border-top: 1px solid #e5e5e5;
  padding-top: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  font-size: 1rem;
  color: #333;
}

.summary-row {
  display: flex;
  justify-content: space-between;
}

.summary-row.total {
  font-weight: 700;
  font-size: 1.2rem;
  color: #7A42F4;
  margin-top: 10px;
}

.small.text-secondary {
  margin-top: 12px;
  font-size: 0.85rem;
  color: #666;
}



/* åº•éƒ¨æŒ‰é’® */
.cart-drawer-footer {
  padding: 20px 28px;
  border-top: 1px solid #e5e5e5;
  background-color: #fafafa;
}

#drawerCheckout {
  display: block;
  width: 100%;
  max-width: 320px; /* æœ€å¤§å®½åº¦é™åˆ¶ï¼Œé¿å…è¿‡å®½ */
  height: 48px; /* å›ºå®šé«˜åº¦ï¼Œæ–¹ä¾¿åšåŠåœ† */
  margin: 0 auto;
  padding: 0; /* å›ºå®šé«˜åº¦å–æ¶ˆ padding */
  border: none;
  border-radius: 50px; /* å®Œå…¨èƒ¶å›Šï¼ˆåŠåœ†ï¼‰å½¢çŠ¶ */
  background: linear-gradient(135deg, #8E57F4, #6B32C9);
  color: #FFFFFF;
  font-size: 1.2rem;
  font-weight: 700;
  text-align: center;
  line-height: 48px; /* æ–‡å­—å‚ç›´å±…ä¸­ */
  text-decoration: none;
  box-shadow:
    inset 0 -2px 4px rgba(0, 0, 0, 0.2),
    0 4px 12px rgba(107, 50, 201, 0.4);
  transition:
    transform 0.2s ease,
    box-shadow 0.2s ease,
    background 0.3s ease;
  cursor: pointer;
  user-select: none;
}

#drawerCheckout:hover {
  background: linear-gradient(135deg, #A176F7, #7E4EF2);
  transform: translateY(-2px);
  box-shadow:
    inset 0 -2px 4px rgba(0, 0, 0, 0.2),
    0 8px 20px rgba(107, 50, 201, 0.5);
}

#drawerCheckout:active {
  transform: translateY(0);
  box-shadow:
    inset 0 2px 4px rgba(0, 0, 0, 0.2),
    0 2px 8px rgba(107, 50, 201, 0.4);
}

/* è‡ªå®šä¹‰æ»šåŠ¨æ¡ï¼ˆWebkitæµè§ˆå™¨ï¼‰ */
#cartDrawer::-webkit-scrollbar {
  width: 8px;
}

#cartDrawer::-webkit-scrollbar-track {
  background: #f9f9f9;
  border-radius: 10px;
}

#cartDrawer::-webkit-scrollbar-thumb {
  background: #7A42F4;
  border-radius: 10px;
}

#cartDrawer::-webkit-scrollbar-thumb:hover {
  background: #5E2DB1;
}



  </style>

</head>

<body>

  <!-- ======================
       â‘¡ é¡µé¢ä¸»ä½“ HTML ç»“æ„åŒº
       ====================== -->
  <div class="container py-4">

    <!-- â‘¡-1 Breadcrumb -->
    <nav aria-label="breadcrumb" class="mb-3">
      <ol class="breadcrumb bg-transparent p-0 mb-0">
        <li class="breadcrumb-item"><a href="#">Furniture</a></li>
        <li class="breadcrumb-item"><a href="#">Office Chairs</a></li>
        <li class="breadcrumb-item active" aria-current="page">Bijander 35â€ Velvet Task Chair</li>
      </ol>
    </nav>

    <div class="row g-5">
      <!-- â‘¡-2 äº§å“ç”»å»Š -->
      <div class="col-md-6">
        <div class="product-gallery">
          <img src="main1.jpg" alt="Main Image" class="main-img" id="mainImage">
          <div class="thumbs mt-2">
            <img src="main1.jpg" class="active" onclick="switchImage(this)">
            <img src="main2.jpg" onclick="switchImage(this)">
            <img src="main3.jpg" onclick="switchImage(this)">
            <img src="main4.jpg" onclick="switchImage(this)">
          </div>
        </div>
      </div>

      <!-- â‘¡-3 äº§å“ä¿¡æ¯ -->
      <div class="col-md-6">
        <h1 class="product-title">Bijander 35â€ Velvet Task Chair</h1>
        <p class="product-sub">Comfortable velvet + adjustable height for home or office use</p>
        <div class="d-flex align-items-center mt-2">
          <div class="rating">â˜…â˜…â˜…â˜…â˜…</div><span>(266 Reviews)</span>
        </div>
        <div class="price">$349.00</div>

        <div class="mt-4">
          <label class="variant-label" for="variantSelect">Color</label>
          <select class="form-select" id="variantSelect">
            <option value="gid://shopify/ProductVariant/54634094526788">Classic Gray</option>
            <option value="gid://shopify/ProductVariant/54634094526788">Navy Blue</option> 
            <option value="gid://shopify/ProductVariant/54634094526788">Emerald Green</option>
          </select>
        </div>
        <div class="mt-3">
          <label class="variant-label" for="qtyInput">Quantity</label>
          <input type="number" class="form-control w-25" id="qtyInput" value="1" min="1" max="10">
        </div>

        <div class="mt-4 d-flex gap-3 flex-column">
          <div class="d-flex gap-3">
            <button class="btn btn-primary btn-lg" id="addToCartBtn">Add to Cart</button>
            <button class="btn btn-outline-secondary btn-lg">Buy
              Now</button>
          </div>
          <div id="message" style="margin-top:10px; font-weight:600; color:#28a745; min-height: 24px;"></div>
        </div>

        <div class="mt-4 text-muted"><small>Ships in 7â€“14 days. Free shipping included.</small></div>
      </div>
    </div>

    <!-- â‘¡-4 Tabs Section (è¯¦æƒ…åŒºåŸŸ) -->
    <div class="details-section">
      <!-- tabs content omitted for brevity -->
    </div>

    <!-- â‘¡-5 Related Products (ç›¸å…³äº§å“) -->
    <div class="related mt-5">
      <!-- related products content omitted for brevity -->
    </div>

  </div>
<!-- â‘¡-6 Cart Drawer (è´­ç‰©è½¦æŠ½å±‰) - ç²¾ç®€å¹¶ç”± JS åŠ¨æ€æ¸²æŸ“ -->
<div id="cartDrawer" class="cart-drawer" aria-label="Shopping Cart" role="region" aria-hidden="true">
  <div class="cart-drawer-header">
    <span>ğŸ›’ Your Cart</span>
    <button class="close-btn" id="closeDrawer" aria-label="Close Cart Drawer">Ã—</button>
  </div>

  <div class="cart-drawer-body">
    <p class="checkout-hint">ğŸ”¥ 197 people are checking out now</p>

    <!-- å•†å“æ¸²æŸ“åŒºåŸŸï¼ˆç”± JS æ’å…¥ï¼‰ -->
    <div id="drawerCartItems"></div>

    <!-- åŠ¨æ€ä»·æ ¼æ±‡æ€»ï¼ˆå¯é€‰ç”± JS è®¾ç½®ï¼‰ -->
    <div class="cart-summary" id="drawerCartSummary" style="margin-top: 15px;">
      <!-- JS ä¼šæ’å…¥ Subtotalã€Total -->
    </div>

    <p class="small text-secondary mt-3" style="color:#777;">
      Taxes and discount codes calculated at checkout.
    </p>
  </div>

  <div class="cart-drawer-footer">
    <a href="#" target="_blank" id="drawerCheckout" class="btn btn-checkout" role="button" aria-label="Proceed to Checkout">Proceed to Checkout â†’</a>
  </div>
</div>


  <!-- â‘¡-7 Message Display Area (æ¶ˆæ¯æ˜¾ç¤ºåŒºåŸŸ) -->
  <div id="message" style="margin-top:10px; font-weight:600; color:#28a745;"></div> 


 <!-- ====================== -->
  <!-- â‘¢ JavaScript è„šæœ¬åŒºåŸŸ -->
  <!-- ====================== -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    /* â‘¢-1 Image Switch Function (å›¾ç‰‡åˆ‡æ¢åŠŸèƒ½) */
    function switchImage(el) {
      document.getElementById('mainImage').src = el.src;
      document.querySelectorAll('.thumbs img').forEach(i => i.classList.remove('active'));
      el.classList.add('active');
    }

    /* â‘¢-2 DOM Elements Cache (DOMå…ƒç´ ç¼“å­˜) */
    const addToCartBtn = document.getElementById('addToCartBtn');
    const variantSelect = document.getElementById('variantSelect');
    const qtyInput = document.getElementById('qtyInput');
    const messageEl = document.getElementById('message');

    const drawer = document.getElementById('cartDrawer');
    const drawerItems = document.getElementById('drawerCartItems');
    const drawerCheckout = document.getElementById('drawerCheckout');
    const closeDrawer = document.getElementById('closeDrawer');

    /* â‘¢-3 Message Timeout Handle */
    let clearMsgTimeout = null;

    /* â‘¢-4 Show Message Function (æ¶ˆæ¯æ˜¾ç¤ºå‡½æ•°) */
    function showMessage(text, type = 'success', duration = 4000) {
      const colors = {
        success: '#28a745',
        error: '#dc3545',
        info: '#0d6efd'
      };
      if (clearMsgTimeout) {
        clearTimeout(clearMsgTimeout);
        clearMsgTimeout = null;
      }
      messageEl.textContent = text;
      messageEl.style.color = colors[type] || '#000';

      if (type === 'success' || type === 'error') {
        clearMsgTimeout = setTimeout(() => {
          messageEl.textContent = '';
          clearMsgTimeout = null;
        }, duration);
      }
    }

    

    /* â‘¢-5 Render Cart Drawer Content (æ¸²æŸ“è´­ç‰©è½¦æŠ½å±‰å†…å®¹ï¼ŒåŒ…æ‹¬ä»·æ ¼) */

function renderCart(cart) {
  drawerItems.innerHTML = ''; // æ¸…ç©ºæ—§å†…å®¹

  // æ¸²æŸ“å•†å“è¡Œ
  cart.lines.edges.forEach(({ node }) => {
    const variantId = node.merchandise.id;
    const quantity = node.quantity;

    // å°è¯•åŒ¹é…å½“å‰é¡µé¢ä¸Šçš„ <option> æ¥è·å– Color æ–‡æœ¬
    const optionEl = [...variantSelect.options].find(opt => opt.value === variantId);
    const colorLabel = optionEl ? optionEl.textContent : 'Selected Variant';

    const item = document.createElement('div');
    item.style.marginBottom = '10px';
    item.innerHTML = `
      <div style="font-weight: bold;">Color: ${colorLabel}</div>
      <div style="font-size: 14px; color: #555;">Quantity: ${quantity}</div>
    `;
    drawerItems.appendChild(item);
  });

  // æ¸²æŸ“ä»·æ ¼æ±‡æ€»
  if (cart.cost) {
    const subtotal = cart.cost.subtotalAmount?.amount || '0.00';
    const total = cart.cost.totalAmount?.amount || '0.00';

    const summary = document.createElement('div');
    summary.className = 'cart-summary mt-3';
    summary.innerHTML = `
      <div class="summary-row">
        <span>Subtotal</span>
        <span>$${subtotal}</span>
      </div>
      <div class="summary-row">
        <span>Shipping</span>
        <span>Free</span>
      </div>
      <div class="summary-row total">
        <span>Total</span>
        <span>$${total}</span>
      </div>
    `;
    drawerItems.appendChild(summary);
  }

  drawerCheckout.href = cart.checkoutUrl;
  drawer.classList.add('open');
}


/* â‘¢-6 Add To Cart Button Click Handler (æ·»åŠ åˆ°è´­ç‰©è½¦æŒ‰é’®äº‹ä»¶) */
addToCartBtn.addEventListener('click', async () => {
  const merchandiseId = variantSelect.value;
  const quantity = parseInt(qtyInput.value) || 1;

  showMessage('â³ æ­£åœ¨æ·»åŠ åˆ°è´­ç‰©è½¦ï¼Œè¯·ç¨å€™...', 'info', 6000);
  addToCartBtn.disabled = true;

try {
  const res = await fetch('http://localhost:8888/.netlify/functions/add-to-cart', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ merchandiseId, quantity })
  });


    if (!res.ok) {
      const err = await res.json();
      showMessage('âŒ æ·»åŠ å¤±è´¥: ' + (err.error || 'æœªçŸ¥é”™è¯¯'), 'error', 5000);
      addToCartBtn.disabled = false;
      return;
    }

    const data = await res.json();

    // æ˜¾ç¤ºè´­ç‰©è½¦æŠ½å±‰
    setTimeout(() => {
      renderCart(data);
      showMessage('âœ… å·²æˆåŠŸåŠ å…¥è´­ç‰©è½¦ï¼', 'success', 2000);
    }, 1200);

  } catch (err) {
    console.error(err);
    showMessage('âŒ ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error', 5000);
  } finally {
    setTimeout(() => {
      addToCartBtn.disabled = false;
    }, 5000);
  }
});


/* â‘¢-7 Close Cart Drawer Button Click Handler (å…³é—­è´­ç‰©è½¦æŠ½å±‰äº‹ä»¶) */
closeDrawer.addEventListener('click', () => {
  drawer.classList.remove('open'); // å…³é—­è´­ç‰©è½¦æŠ½å±‰
});

  </script>
</body>

</html> 